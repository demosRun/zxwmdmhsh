<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <!-- 页面的元信息 -->
    <title>{TAG_14226_TAG}</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"/>
    <meta name="format-detection" content="telephone=no, email=no"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="white"/>
    <meta name="renderer" content="webkit"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="filetype" content="1"/>
    <meta name="publishedtype" content="1"/>
    <meta name="pagetype" content="2"/>
    <meta name="screen-orientation" content="landscape"/>
    <meta name="x5-orientation" content="landscape"/>
    <meta name="full-screen" content="yes"/>
    <meta name="x5-fullscreen" content="true"/>
    <meta name="browsermode" content="application"/>
    <meta name="x5-page-mode" content="app"/>
    
      <!-- 页面主样式文件 -->
      <link charset="utf-8"  rel="stylesheet" href="./static/css/owo.core.css">
      
    <!-- 附属css文件 -->
    <link rel="stylesheet" href="./static/css/main.css" charset="utf-8">
      
  </head>
  <body>
    
    <!-- 页面[loading]-->
    <div class="loading-box page" template="loading" style="display: none;"><img class="loading" src="https://cunchu.site/ozzx/resource/loadingLogo.png"><div class="loading-bar"><div class="num-bar"></div></div><span class="text">Loading</span><div class="num">0%</div></div>
    <!-- 页面[page1]-->
    <div class="page-1 page" template="page1" style="display: none;"><div id="container"></div><div class="conn-box"><input type="text" o-value="this.data.inputValue"><input type="number" o-value="this.data.beishu"><span o-tap="changeValue('position', 'y', 1)">上</span><span o-tap="changeValue('position', 'y', -1)">下</span><span o-tap="changeValue('position', 'x', -1)">左</span><span o-tap="changeValue('position', 'x', 1)">右</span><span o-tap="changeValue('position', 'z', -1)">前</span><span o-tap="changeValue('position', 'z', 1)">后</span><span o-tap="changeValue('rotation', 'y', 0.1)">左转</span><span o-tap="changeValue('rotation', 'y', -0.1)">右转</span><span o-tap="changeValue('rotation', 'x', 0.1)">抬头</span><span o-tap="changeValue('rotation', 'x', -0.1)">低头</span></div><div class="scale-box"><div class="so so-0"><img class="so so-1" src="./static/resource/1338.png"><img class="so so-2" src="./static/resource/625.png"><img class="so so-3" src="./static/resource/660.png" o-animation="shrink"><img class="so so-4" src="./static/resource/1635.png"><img class="so so-5" src="./static/resource/1633.png"><div class="so so-6"><img class="so so-7" src="./static/resource/1630.png"><img class="so so-8" src="./static/resource/1631.png"></div><img class="so so-9" src="./static/resource/886.png"></div></div></div>
    
<!-- 框架script文件 -->
<script src="./static/js/owo.core.js" type="text/javascript" charset="UTF-8"></script>
<script type="text/javascript" charset="UTF-8">
// 模块 page1 的script代码
infoData = [{
  "id": 886,
  "name": "bg",
  "itemIndex": 45,
  "opacity": 100,
  "visible": true,
  "bounds": {
    "left": 0,
    "top": -0,
    "index": -393,
    "right": 0,
    "bottom": 750,
    "width": 1548,
    "height": 750,
    "relativeLeft": 0,
    "relativeTop": 0,
    "relativeRight": 0,
    "relativeBottom": 0,
    "percentageLeft": 0,
    "percentageRight": 0,
    "percentageTop": 0,
    "percentageBottom": 0,
    "percentageHeight": 100,
    "percentageWidth": 100,
    "fileWeight": 1548,
    "fileHeight": 750
  },
  "typename": "ArtLayer",
  "width": 1548,
  "height": 750,
  "kind": "NORMAL",
  "isBackgroundLayer": false,
  "fileName": "./static/resource/886.png"
}];
owo.script = {
  "loading": {
    "data": {
      "imgList": [""]
    },
    "show": function show() {
      var mum = owo.query('.num')[0];
      var numBar = owo.query('.num-bar')[0];
      this.preloadImages(this.data.imgList, function (e) {
        setTimeout(function () {
          owo.go('page1////true');
        }, 500);
      }, function (num) {
        numBar.style.width = num + '%';
        mum.innerHTML = num + '%';
      });
    },
    "preloadImage": function preloadImage(src, successFn) {
      var image = new Image();
      image.src = src;

      image.onload = function () {
        successFn && successFn(src);
      };

      image.onerror = function (error) {
        successFn && successFn(src);
      };
    },
    "preloadImages": function preloadImages(srcs, doneFn, progressFn) {
      var _this = this;

      if (!Array.isArray(srcs)) {
        console.log('第一个参数只能是一个数组');
      } else {
        var allCount = srcs.length;
        var doneCount = 0;
        srcs.forEach(function (srcItem) {
          _this.preloadImage(srcItem, function () {
            doneCount++;
            progressFn && progressFn(Math.ceil(100 * doneCount / allCount));

            if (doneCount === allCount) {
              doneFn && doneFn();
            }
          });
        });
      }
    }
  },
  "page1": {
    "data": {
      "inputValue": "",
      "beishu": 1,
      "shareShow": false,
      "clickObjects": [],
      "playing": false,
      "step": 0,
      "busying": true,
      "nmMusic": null,
      "videoIsPlay": false,
      "nameIsShow": false
    },
    "created": function created() {
      this.init();
    },
    "init": function init() {
      var container = document.getElementById('container'); // 设立相机

      camera = new THREE.PerspectiveCamera(75, window.innerWidth > window.innerHeight ? window.innerWidth / window.innerHeight : window.innerHeight / window.innerWidth, 0.1, 800);
      camera.position.set(0, 0, 90);
      camera.lookAt(0, 0, 0); // 建立一个场景

      scene = new THREE.Scene();
      scene.fog = new THREE.Fog(0xffffff, 100, 300000); // 像素级的渲染，渲染效果更好

      renderer = new THREE.WebGLRenderer({
        // antialias: true,
        depthTest: false
      });
      renderer.setClearColor(0xfffefb, 1.0);
      renderer.setPixelRatio(window.devicePixelRatio);
      if (window.innerWidth > window.innerHeight) renderer.setSize(window.innerWidth, window.innerHeight);else {
        renderer.setSize(window.innerHeight, window.innerWidth);
      }
      container.appendChild(renderer.domElement); // renderer.outputEncoding = THREE.sRGBEncoding;
      // renderer.toneMapping = THREE.ACESFilmicToneMapping;

      var pmremGenerator = new THREE.PMREMGenerator(renderer); // pmremGenerator.compileEquirectangularShader();

      window.addEventListener('resize', this.onWindowResize, false);
      renderer.setAnimationLoop(render); // renderer.sortObjects = true;
      // 添加光线
      // var ambientLight = new THREE.AmbientLight(0xffffff);
      // scene.add(ambientLight);
      // var pointLight = new THREE.PointLight("#ffffff");
      // pointLight.position.set(0,10,0);
      // scene.add(pointLight);
      // 添加控制器
      // controls = new THREE.OrbitControls( camera, container );
      // controls.target.set( 150, -50, 150 );
      // controls.update();

      this.creatMode();

      function render() {
        renderer.render(scene, camera);
      } // this.initThreeClickEvent()

    },
    "creatMode": function creatMode() {
      var _this2 = this;

      // 辅助参考线
      // var grid = new THREE.GridHelper(500, 100);
      // grid.rotation.x = 90 / 180 * Math.PI
      // scene.add(grid);
      // console.log(infoData)
      infoData.forEach(function (element) {
        var bounds = element.bounds;
        new THREE.TextureLoader().load(element.fileName, function (texture) {
          var obgW = bounds.width;
          var obgH = bounds.height;
          var objL = bounds.left;
          var objT = bounds.top; // console.log(element.name)

          texture.minFilter = THREE.LinearFilter; // MeshBasicMaterial SpriteMaterial

          var textObj = new THREE.MeshBasicMaterial({
            map: texture,
            opacity: element.opacity / 100,
            transparent: true,
            color: 0xffffff,
            depthTest: false,
            sizeAttenuation: false
          });
          var logo = new THREE.Sprite(textObj);
          logo.scale.set(element.width, element.height, 0.1);
          logo.name = element.name;
          console.log(element.name);
          if (element.rotationY) logo.rotation.y = element.rotationY;
          if (element.rotationX) logo.rotation.x = element.rotationX;
          logo.updateMatrix();
          logo.position.set(objT, objL, bounds.index || 0);
          scene.add(logo);

          if (element.name.startsWith('文字-')) {
            _this2.data.clickObjects.push(logo);
          }
        });
      });
    },
    "changeValue": function changeValue(item, key, value) {
      value = parseFloat(value) * this.data.beishu;
      var target = scene.getObjectByName(this.data.inputValue);

      if (target) {
        target[item][key] += value;
        console.log({
          left: target.position.x,
          top: -target.position.y,
          index: target.position.z,
          rotationY: target.rotation.y
        });
      }
    }
  }
};
</script>

    <script src="./static/js/autoScale.js" type="text/javascript"  charset="UTF-8"></script>
    <script src="http://rmfp.people.com.cn/img/MAIN/2020/08/120400/static/js/three.min.js" type="text/javascript"  charset="UTF-8"></script>
    <script src="./static/js/main.js" type="text/javascript"  charset="UTF-8"></script>
    <script src="http://tools.people.com.cn/libs/jquery/1.11.1/jquery-1.11.1.min.js" type="text/javascript"  charset="UTF-8"></script>
    <script src="http://rmfp.people.com.cn/img/MAIN/2020/08/120400/static/js/TweenMax.js" type="text/javascript"  charset="UTF-8"></script>

  </body>
</html>